# 스레드
프로세스의 코드에 정의된 절차에 따라 CPU에 작업 요청을 하는 실행 단위이다.

## 멀티 스레드
하나의 프로세스 내 작업을 여러 개의 스레드로 분할함으로써 작업의 부담을 줄이는 프로세스 운영 기법

## 멀티 태스킹
여러 개의 스레드의 시간을 잘게 나누어 CPU가 번갈아가며 작업을 수행하도록 하는 기법(시분할 시스템)

## 멀티 프로세싱
CPU를 여러 개 사용하여 여러 개의 스레드를 동시에 처리하는 기법

## CPU 멀티 스레드
CPU가 여러 개인 멀티 프로세싱 기법을 사용하여 여러 개의 스레드를 동시에 처리하는 기법

## 멀티 스레드의 구조
C언어와 같은 초기의 프로그래밍 언어는 순차적으로 실행되기 때문에 프로세스로 여러 개의 작업을 동시에 처리하기가 불편했다. 여러 개의 작업을 동시에 처리하기 위해
fork() 함수를 사용하여 프로세스를 생성하고, 생성된 프로세스에 작업을 할당하는 방식을 사용했다. 이 방식은 낭비되는 요소가 많다. 코드 영역과 데이터 영역의 일부가 중복되는 등 자원의 낭비가 심하다.

이러한 문제를 해결하기 위해 멀티 스레드를 사용한다.
- 프로세스는 크게 정적인 영역과 동적인 영역으로 구분된다.
  - 정적인 영역은 프로세스가 실행되는 동안 바뀌지 않는 영역이고, 동적인 영역은 프로세스가 실행되는 동안 바뀌는 영역이다.
  - 하나의 프로세스내에 여러 개의 스레드를 생성하여 정적인 영역을 공유하고, 동적인 영역만 따로 할당하여 사용한다.
- 멀티 스레드의 장점
  - 응답성 향상: 한 스레드가 입출력으로 인해 작업이 진행되지 않더라도 다른 스레드가 작업을 처리할 수 있다.
  - 자원 공유: 하나의 프로세스 내에서 스레드가 공유하는 자원이 있기 때문에 자원을 공유하는 것이 쉽다.
  - 효율성 향상: 여러 개의 프로세스를 생성하는 것과 달리 멀티 스레드는 불필요한 자원의 중복을 막을 수 있다.
  - 다중 CPU 지원: 2개 이상의 CPU를 가진 컴퓨터에서 멀티스레드를 사용하면 다중 CPU가 멀티스레드를 동시에 처리하여 CPU 사용량이 증가하고 프로세스의 처리 시간이 단축된다.
- 멀티 스레드의 단점
  - 안정성 저하: 하나의 스레드가 데이터 공간을 망가뜨리면 모든 스레드가 작동하지 않을 수 있다.

## 멀티 스레드 모델
- 커널 스레드: 커널이 직접 생성하고 관리하는 스레드
- 사용자 스레드: 라이브러리에 의해 구현된 일반적인 스레드

사용자 스레드가 커널 스레드를 사용하려면 시스템 호출로 커널 기능을 이용해야 한다. 이때 커널 스레드와 사용자 스레드의 대응 방식에 따라 다음과 같이 분류된다.

- 사용자 스레드:
  - 운영체제가 멀티스레드를 지원하지 않을 때 사용하는 방법으로 초기의 스레드 시스템에서 이용되었다. 사용자 스레드는 커널 입장에서 하나의 프로세스처럼 
  인식한다. 사용자 스레드 n개가 커널 스레드 1개와 연결된 형태다.
  - 장점: 사용자 스레드는 라이브러리가 직접 스케쥴링을 하고 작업에 필요한 정보를 처리하기 때문에 문맥 교환이 필요 없다. 따라서 속도가 빠르다.
  - 단점:
    - 사용자 스레드는 커널 스레드 하나와 연결되기 때문에 커널 스레드가 입출력 작업을 위해 대기 상태에 들어가면 모든 사용자 스레드가 같이 대기해야 한다.
    - 한 프로세스의 타임 슬라이스를 여러 스레드가 공유하기 때문에 여러 개의 CPU를 동시에 사용할 수 없다는 것이다.
    - 보안에 취약하다. 커널 레벨에서는 공유 변수를 보호하는 장치가 있으나 사용자 스레드는 라이브러리에서 구현해야 하기 때문이다.
- 커널 스레드:
  - 커널 스레드는 커널이 멀티스레드를 지원하는 방식으로, 하나의 사용자 스레드가 하나의 커널 스레드와 연결되기 때문에 1:1 모델이라고도 한다.
  커널 스레드는 독립적으로 스케쥴링이 되므로 특정 스레드가 대기 상태에 들어가도 다른 스레드는 작업을 계속할 수 있다.
  - 장점: 커널 스레드는 독립적으로 스케쥴링이 되기 때문에 특정 스레드가 대기 상태에 들어가도 다른 스레드는 작업을 계속할 수 있다.
  - 단점: 문맥 교환을 위해 커널이 관여하기 때문에 속도가 느리다.
- 하이브리드 스레드:
  - 사용자 스레드와 커널 스레드를 혼합한 방식으로, 사용자 스레드 n개가 커널 스레드 m개와 연결되는 형태다.
  - 장점: 커널 스레드와 사용자 스레드의 장점을 모두 가지고 있다.
  - 단점: 사용자 스레드와 커널 스레드의 관리가 복잡하다.